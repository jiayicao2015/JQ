import{c as D,a as m,h as b,b as N,g as F,i as U,e as P,l as j,r as x,w as H,o as ae,d as se,p as oe,f as ue,j as ce,k as $,m as de,n as fe,q as G,s as ve,t as he,u as me,v as ie,x as T,y as V,z as ge,A as pe,B as we,C as ye,D as be,E as Q,F as Se,G as _,H as Y,I as B,J as xe,Q as Ce,K as ze,L as J,M as X}from"./index-ByIh06HG.js";import{Q as k,g as R,a as He,_ as We,u as Be,b as _e,c as Le,U as z,S as Z,H as Pe}from"./_plugin-vue_export-helper-zQPlLHzM.js";import"./pinia-cC4VbiFp.js";const Te=D({name:"QToolbarTitle",props:{shrink:Boolean},setup(e,{slots:n}){const a=m(()=>"q-toolbar__title ellipsis"+(e.shrink===!0?" col-shrink":""));return()=>b("div",{class:a.value},N(n.default))}}),Ve=D({name:"QToolbar",props:{inset:Boolean},setup(e,{slots:n}){const a=m(()=>"q-toolbar row no-wrap items-center"+(e.inset===!0?" q-toolbar--inset":""));return()=>b("div",{class:a.value,role:"toolbar"},N(n.default))}}),Fe=D({name:"QHeader",props:{modelValue:{type:Boolean,default:!0},reveal:Boolean,revealOffset:{type:Number,default:250},bordered:Boolean,elevated:Boolean,heightHint:{type:[String,Number],default:50}},emits:["reveal","focusin"],setup(e,{slots:n,emit:a}){const{proxy:{$q:i}}=F(),l=U(j,P);if(l===P)return console.error("QHeader needs to be child of QLayout"),P;const d=x(parseInt(e.heightHint,10)),f=x(!0),o=m(()=>e.reveal===!0||l.view.value.indexOf("H")!==-1||i.platform.is.ios&&l.isContainer.value===!0),c=m(()=>{if(e.modelValue!==!0)return 0;if(o.value===!0)return f.value===!0?d.value:0;const t=d.value-l.scroll.value.position;return t>0?t:0}),s=m(()=>e.modelValue!==!0||o.value===!0&&f.value!==!0),h=m(()=>e.modelValue===!0&&s.value===!0&&e.reveal===!0),w=m(()=>"q-header q-layout__section--marginal "+(o.value===!0?"fixed":"absolute")+"-top"+(e.bordered===!0?" q-header--bordered":"")+(s.value===!0?" q-header--hidden":"")+(e.modelValue!==!0?" q-layout--prevent-focus":"")),y=m(()=>{const t=l.rows.value.top,r={};return t[0]==="l"&&l.left.space===!0&&(r[i.lang.rtl===!0?"right":"left"]=`${l.left.size}px`),t[2]==="r"&&l.right.space===!0&&(r[i.lang.rtl===!0?"left":"right"]=`${l.right.size}px`),r});function v(t,r){l.update("header",t,r)}function g(t,r){t.value!==r&&(t.value=r)}function M({height:t}){g(d,t),v("size",t)}function L(t){h.value===!0&&g(f,!0),a("focusin",t)}H(()=>e.modelValue,t=>{v("space",t),g(f,!0),l.animate()}),H(c,t=>{v("offset",t)}),H(()=>e.reveal,t=>{t===!1&&g(f,e.modelValue)}),H(f,t=>{l.animate(),a("reveal",t)}),H(l.scroll,t=>{e.reveal===!0&&g(f,t.direction==="up"||t.position<=e.revealOffset||t.position-t.inflectionPoint<100)});const W={};return l.instances.header=W,e.modelValue===!0&&v("size",d.value),v("space",e.modelValue),v("offset",c.value),ae(()=>{l.instances.header===W&&(l.instances.header=void 0,v("size",0),v("offset",0),v("space",!1))}),()=>{const t=se(n.default,[]);return e.elevated===!0&&t.push(b("div",{class:"q-layout__shadow absolute-full overflow-hidden no-pointer-events"})),t.push(b(k,{debounce:0,onResize:M})),b("header",{class:w.value,style:y.value,onFocusin:L},t)}}}),Me=D({name:"QPageContainer",setup(e,{slots:n}){const{proxy:{$q:a}}=F(),i=U(j,P);if(i===P)return console.error("QPageContainer needs to be child of QLayout"),P;oe(ue,!0);const l=m(()=>{const d={};return i.header.space===!0&&(d.paddingTop=`${i.header.size}px`),i.right.space===!0&&(d[`padding${a.lang.rtl===!0?"Left":"Right"}`]=`${i.right.size}px`),i.footer.space===!0&&(d.paddingBottom=`${i.footer.size}px`),i.left.space===!0&&(d[`padding${a.lang.rtl===!0?"Right":"Left"}`]=`${i.left.size}px`),d});return()=>b("div",{class:"q-page-container",style:l.value},N(n.default))}}),qe=D({name:"QLayout",props:{container:Boolean,view:{type:String,default:"hhh lpr fff",validator:e=>/^(h|l)h(h|r) lpr (f|l)f(f|r)$/.test(e.toLowerCase())},onScroll:Function,onScrollHeight:Function,onResize:Function},setup(e,{slots:n,emit:a}){const{proxy:{$q:i}}=F(),l=x(null),d=x(i.screen.height),f=x(e.container===!0?0:i.screen.width),o=x({position:0,direction:"down",inflectionPoint:0}),c=x(0),s=x(ce.value===!0?0:R()),h=m(()=>"q-layout q-layout--"+(e.container===!0?"containerized":"standard")),w=m(()=>e.container===!1?{minHeight:i.screen.height+"px"}:null),y=m(()=>s.value!==0?{[i.lang.rtl===!0?"left":"right"]:`${s.value}px`}:null),v=m(()=>s.value!==0?{[i.lang.rtl===!0?"right":"left"]:0,[i.lang.rtl===!0?"left":"right"]:`-${s.value}px`,width:`calc(100% + ${s.value}px)`}:null);function g(u){if(e.container===!0||document.qScrollPrevented!==!0){const p={position:u.position.top,direction:u.direction,directionChanged:u.directionChanged,inflectionPoint:u.inflectionPoint.top,delta:u.delta.top};o.value=p,e.onScroll!==void 0&&a("scroll",p)}}function M(u){const{height:p,width:C}=u;let S=!1;d.value!==p&&(S=!0,d.value=p,e.onScrollHeight!==void 0&&a("scrollHeight",p),W()),f.value!==C&&(S=!0,f.value=C),S===!0&&e.onResize!==void 0&&a("resize",u)}function L({height:u}){c.value!==u&&(c.value=u,W())}function W(){if(e.container===!0){const u=d.value>c.value?R():0;s.value!==u&&(s.value=u)}}let t=null;const r={instances:{},view:m(()=>e.view),isContainer:m(()=>e.container),rootRef:l,height:d,containerHeight:c,scrollbarWidth:s,totalWidth:m(()=>f.value+s.value),rows:m(()=>{const u=e.view.toLowerCase().split(" ");return{top:u[0].split(""),middle:u[1].split(""),bottom:u[2].split("")}}),header:$({size:0,offset:0,space:!1}),right:$({size:300,offset:0,space:!1}),footer:$({size:0,offset:0,space:!1}),left:$({size:300,offset:0,space:!1}),scroll:o,animate(){t!==null?clearTimeout(t):document.body.classList.add("q-body--layout-animate"),t=setTimeout(()=>{t=null,document.body.classList.remove("q-body--layout-animate")},155)},update(u,p,C){r[u][p]=C}};if(oe(j,r),R()>0){let u=function(){S=null,q.classList.remove("hide-scrollbar")},p=function(){if(S===null){if(q.scrollHeight>i.screen.height)return;q.classList.add("hide-scrollbar")}else clearTimeout(S);S=setTimeout(u,300)},C=function(I){S!==null&&I==="remove"&&(clearTimeout(S),u()),window[`${I}EventListener`]("resize",p)},S=null;const q=document.body;H(()=>e.container!==!0?"add":"remove",C),e.container!==!0&&C("add"),de(()=>{C("remove")})}return()=>{const u=fe(n.default,[b(He,{onScroll:g}),b(k,{onResize:M})]),p=b("div",{class:h.value,style:w.value,ref:e.container===!0?void 0:l,tabindex:-1},u);return e.container===!0?b("div",{class:"q-layout-container overflow-hidden",ref:l},[b(k,{onResize:L}),b("div",{class:"absolute-full",style:y.value},[b("div",{class:"scroll",style:v.value},[p])])]):p}}});function Ie(e){return he()?(me(e),!0):!1}const A=new WeakMap,Qe=(...e)=>{var n;const a=e[0],i=(n=F())==null?void 0:n.proxy;if(i==null&&!ie())throw new Error("injectLocal must be called in setup");return i&&A.has(i)&&a in A.get(i)?A.get(i)[a]:U(...e)},De=typeof window<"u"&&typeof document<"u";typeof WorkerGlobalScope<"u"&&globalThis instanceof WorkerGlobalScope;const $e=Object.prototype.toString,Re=e=>$e.call(e)==="[object Object]";function ee(e){return e.endsWith("rem")?Number.parseFloat(e)*16:Number.parseFloat(e)}function E(e){return Array.isArray(e)?e:[e]}function Ae(e){return F()}function Ee(e,n=!0,a){Ae()?G(e,a):n?e():ve(e)}function ke(e,n,a){return H(e,n,{...a,immediate:!0})}const K=De?window:void 0;function Oe(e){var n;const a=V(e);return(n=a?.$el)!=null?n:a}function O(...e){const n=[],a=()=>{n.forEach(o=>o()),n.length=0},i=(o,c,s,h)=>(o.addEventListener(c,s,h),()=>o.removeEventListener(c,s,h)),l=m(()=>{const o=E(V(e[0])).filter(c=>c!=null);return o.every(c=>typeof c!="string")?o:void 0}),d=ke(()=>{var o,c;return[(c=(o=l.value)==null?void 0:o.map(s=>Oe(s)))!=null?c:[K].filter(s=>s!=null),E(V(l.value?e[1]:e[0])),E(pe(l.value?e[2]:e[1])),V(l.value?e[3]:e[2])]},([o,c,s,h])=>{if(a(),!o?.length||!c?.length||!s?.length)return;const w=Re(h)?{...h}:h;n.push(...o.flatMap(y=>c.flatMap(v=>s.map(g=>i(y,v,g,w)))))},{flush:"post"}),f=()=>{d(),a()};return Ie(a),f}function Ne(){const e=T(!1),n=F();return n&&G(()=>{e.value=!0},n),e}function Ue(e){const n=Ne();return m(()=>(n.value,!!e()))}const je=Symbol("vueuse-ssr-width");function Ge(){const e=ie()?Qe(je,null):null;return typeof e=="number"?e:void 0}function Ke(e,n={}){const{window:a=K,ssrWidth:i=Ge()}=n,l=Ue(()=>a&&"matchMedia"in a&&typeof a.matchMedia=="function"),d=T(typeof i=="number"),f=T(),o=T(!1),c=s=>{o.value=s.matches};return ge(()=>{if(d.value){d.value=!l.value;const s=V(e).split(",");o.value=s.some(h=>{const w=h.includes("not all"),y=h.match(/\(\s*min-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/),v=h.match(/\(\s*max-width:\s*(-?\d+(?:\.\d*)?[a-z]+\s*)\)/);let g=!!(y||v);return y&&g&&(g=i>=ee(y[1])),v&&g&&(g=i<=ee(v[1])),w?!g:g});return}l.value&&(f.value=a.matchMedia(V(e)),o.value=f.value.matches)}),O(f,"change",c,{passive:!0}),m(()=>o.value)}function Ye(e={}){const{window:n=K,initialWidth:a=Number.POSITIVE_INFINITY,initialHeight:i=Number.POSITIVE_INFINITY,listenOrientation:l=!0,includeScrollbar:d=!0,type:f="inner"}=e,o=T(a),c=T(i),s=()=>{if(n)if(f==="outer")o.value=n.outerWidth,c.value=n.outerHeight;else if(f==="visual"&&n.visualViewport){const{width:w,height:y,scale:v}=n.visualViewport;o.value=Math.round(w*v),c.value=Math.round(y*v)}else d?(o.value=n.innerWidth,c.value=n.innerHeight):(o.value=n.document.documentElement.clientWidth,c.value=n.document.documentElement.clientHeight)};s(),Ee(s);const h={passive:!0};if(O("resize",s,h),n&&f==="visual"&&n.visualViewport&&O(n.visualViewport,"resize",s,h),l){const w=Ke("(orientation: portrait)");H(w,()=>s())}return{width:o,height:c}}const Je={class:"row items-center q-gutter-x-lg"},Xe={class:"content-wrapper"},Ze={class:"device-warning-mask flex flex-center"},et={class:"window-warning-mask fixed-full flex flex-center"},te=1280,ne=720,tt={__name:"MainLayout",setup(e){const n=Le(),a=Be(),i=_e(),l=x(!1),d=x(!1),f=m(()=>d.value?l.value?"Disconnecting":"Connecting...":l.value?"Disconnect":"Connect");let o=new Uint8Array(0);async function c(){d.value=!0;try{l.value?await v():await w()}catch(t){console.error(t)}finally{d.value=!1}}function s(t){return new Promise(r=>{setTimeout(()=>{r()},t)})}function h(t){const r=t instanceof Uint8Array?t:new Uint8Array(t),u=new Uint8Array(o.length+r.length);u.set(o,0),u.set(r,o.length),o=u}async function w(){if(await a.manager.connect({baudRate:25e4})){const r=await a.manager.validateDevice({queryCommand:Z.hexToBytes(z.generateFlowControlFrame("WEBSITE")),response:Z.hexToBytes("50 43 0A 01 FA 98"),timeout:500});r.result===!0?(await y(),l.value=!0,n.notify("device connected")):(a.manager.disconnect(),l.value=!1,n.notify(`device invalidated ${r.reason}`))}}async function y(){a.manager.off("receive",h),o=new Uint8Array(0),a.manager.on("receive",h);let t=z.generateGetConfigInfoFrame();a.manager.sendHex(t),await s(50);let r=null;if((r=z.verifyFrame(o))===null){a.manager.disconnect(),n.notify("device invalidated");return}let u=r.data[0];i.setHubModel(u);let p=r.data[1];i.setLastBridgeConnCarVendor(p);let C=r.data[2];i.setVersion(C);let S=r.data[3];if(i.setPatchVersion(S),o=new Uint8Array(0),r=null,t=z.generateGetConfigProfileFrame(),a.manager.sendHex(t),await s(50),(r=z.verifyFrame(o))===null){a.manager.disconnect(),n.notify("device invalidated");return}let q=r.data[0];if(i.setProfile(q),o=new Uint8Array(0),r=null,t=z.generateGetConfigButtonFrame(),a.manager.sendHex(t),await s(50),(r=z.verifyFrame(o))===null){a.manager.disconnect(),n.notify("device invalidated");return}let I=[];if(I=Pe.parseRawData(r.data),i.setHubProButtonConfigs([...I]),o=new Uint8Array(0),r=null,t=z.generateGetConfigBrightnessFrame(),a.manager.sendHex(t),await s(50),(r=z.verifyFrame(o))===null){a.manager.disconnect(),n.notify("device invalidated");return}let le=Math.floor(r.data[0]/2.55);i.setDayBrightness(le);let re=Math.floor(r.data[1]/2.55);i.setNightBrightness(re),o=new Uint8Array(0),a.manager.off("receive",h)}async function v(){let t=z.generateFlowControlFrame("STOP");console.log("sendStopData:",t),a.manager.sendHex(t),await s(50),await a.manager.disconnect()&&(n.notify("device disconnected"),l.value=!1)}const{width:g,height:M}=Ye(),L=x(!1),W=we(()=>{if(!n.platform.is.edge&&!n.platform.is.chrome&&!n.platform.is.edgeChromium){alert("Please use a compatible browser(chrome)).");return}L.value=g.value<te||M.value<ne},100);return ae(()=>{window.removeEventListener("resize",W)}),G(()=>{"serial"in navigator?console.log("Web Serial API supported."):alert("Web Serial API not supported. Please use a compatible browser(chrome))."),a.init(),window.addEventListener("resize",W),H(()=>l.value,t=>{a.setIsConnected(t)})}),(t,r)=>{const u=Se("router-view");return be(),ye(qe,{view:"hHh Lpr lFr"},{default:Q(()=>[_(Fe,{elevated:"",class:"bg-black"},{default:Q(()=>[_(Ve,null,{default:Q(()=>[_(Te,null,{default:Q(()=>r[0]||(r[0]=[xe("Madtrace")])),_:1}),B("div",Je,[_(Ce,{name:"circle",size:"18px",color:l.value?"green":"red",class:"serial-indicater"},null,8,["color"]),_(ze,{class:"bg-white text-black",label:f.value,onClick:c,loading:d.value,disable:d.value},null,8,["label","loading","disable"])])]),_:1})]),_:1}),_(Me,null,{default:Q(()=>[B("div",Xe,[_(u),Y(B("div",Ze,r[1]||(r[1]=[B("div",{class:"warning-content text-center q-pa-lg"},[B("p",{class:"text-body1"},"Please connect device first.")],-1)]),512),[[J,!l.value]])])]),_:1}),Y(B("div",et,[B("div",{class:"warning-content text-center q-pa-lg"},[B("p",{class:"text-body1"},"Please Resize Window atleast "+X(te)+" x "+X(ne)+".")])],512),[[J,L.value]])]),_:1})}}},it=We(tt,[["__scopeId","data-v-07789e22"]]);export{it as default};
